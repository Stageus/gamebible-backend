name: 게임바이블 배포스크립트

on:
    pull_request:
        types:
            - closed
        branches:
            - master

jobs:
    if_merged:
        if: github.event.pull_request.merged == true
        runs-on: self-hosted
        steps:
            - name: 레포지토리 체크아웃
              uses: actions/checkout@v2

            - name: 코드 업데이트, 재실행
              run: |
                  echo "PR was merged"
                  pwd
                  cd ./../gamebible-backend/
                  pwd
                  ls -a
                  if [ -d .git ]; then echo ".git directory exists"; else echo ".git directory does not exist"; fi
                  git pull origin master
                  k1ju
                  ${{  secrets.TOKEN  }}
                  sudo pm2 restart 0
